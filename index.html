<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Dynamic Google Sheet Dropdown</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 10px;
      }
      select, input[type="radio"], input[type="checkbox"] {
        margin: 5px 0;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <div id="widgetContainer">
      <p id="loadingMessage">Loading options...</p>
    </div>

    <script>
      const dataUrl = "https://sheets.googleapis.com/v4/spreadsheets/15LC4rMEJlXGIyWTn41rmIAB32t4LXDOM5UNskP8t4Wc/values/A:B?key=AIzaSyDW-WRhESRFREtoq76Ys953GFb_4jvdz08";

      function setAnswer(value) {
        window.parent.postMessage({ action: "setAnswer", value: value }, "*");
      }

      function renderDropdown(options) {
        const select = document.createElement("select");
        select.innerHTML = '<option disabled selected>Please select...</option>';
        options.forEach(option => {
          const opt = document.createElement("option");
          opt.value = option;
          opt.textContent = option;
          select.appendChild(opt);
        });

        select.addEventListener("change", () => {
          setAnswer(select.value);
        });

        document.getElementById("widgetContainer").appendChild(select);
      }

      fetch(dataUrl)
        .then(res => res.json())
        .then(data => {
          const container = document.getElementById("widgetContainer");
          container.innerHTML = ""; // Clear loading

          const values = data.values || [];
          const rows = values.slice(1); // skip header
          const optionsList = rows.map(row => row[0]); // use first column only

          if (optionsList.length > 0) {
            renderDropdown(optionsList);
          } else {
            container.innerHTML = "No data found.";
          }
        })
        .catch(err => {
          console.error("Fetch error:", err);
          document.getElementById("loadingMessage").textContent = "Error loading data.";
        });
    </script>
  </body>
</html>
